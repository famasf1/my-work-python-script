import win32com.client
from cProfile import run
from fileinput import filename
from tkinter import filedialog
from tkinter import *
import openpyxl
import os
import datetime as dt

root1 = Tk()
root1.filedir = filedialog.askdirectory(title="‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Folder ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ü‡∏•‡πå PDF")
root1.filename = filedialog.askopenfilename(initialdir="/",title="‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå Excel",filetypes=(("Excel","*.xlsx"),("All files","*.*")))

workbook = openpyxl.load_workbook(root1.filename, data_only=True)
sheets = workbook.sheetnames
readsheet = workbook[sheets[1]]

def sentmail(): #dummy formula
    os.chdir(root1.filedir)
    attlist = []
    row = 2 #skip first row because it's header
    while True: #not sure why while work but ok
        value1 = readsheet.cell(row=row,column=3).value #first, get value to use as your header
        email2 = readsheet.cell(row=row,column=4).value #second, get email row
        branch3 = readsheet.cell(row=row,column=2).value #Branch ID
        amouth4 = readsheet.cell(row=row,column=5).value #amouth
        # amouth4 = readsheet.cell(row=row,column=9).value #amouth of bill
        outlook = win32com.client.Dispatch("Outlook.Application") #Call outlook
        From = None
        for myEmailAddress in outlook.Session.Accounts:
            if "Kamolwan@comseven.com" in str(myEmailAddress):
                From = myEmailAddress
                break
        j = range(1,row) #thank you stackoverflow 
        mail = outlook.CreateItem(0)
        mail.Subject = 'Print Label DHL ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏° Code 166 Ship To ‡πÅ‡∏ú‡∏ô‡∏Å Service / ‡∏£‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ' + str(dt.datetime.today().strftime("%d/%m/%Y")) + ' / PHYID' + str(value1)
        mail.To = str(email2)
        mail.Cc = 'Saknarin.W <saknarin.w@comseven.com>; Store_Support_Group <store_support_group@comseven.com>'
        html = '''
        <html> \
        <body> \
            <p><strong>‡∏´‡∏•‡∏±‡∏á‡∏ö‡∏¥‡∏•‡∏ô‡∏µ‡πâ‡πÑ‡∏õ ‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡∏Ç‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πà‡∏ß‡∏°‡∏°‡∏∑‡∏≠ ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ö‡∏¥‡∏•‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏∞‡∏Ñ‡∏∞</strong></p>
<p><strong><span style='font-size:21px;font-family:"Leelawadee","sans-serif";color:blue;'>‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</span></strong><strong><span style='font-size:21px;font-family:"Leelawadee","sans-serif";color:blue;'>&nbsp; ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö &nbsp;ITECINSURANCE &nbsp;‡∏´‡∏£‡∏∑‡∏≠ ITEC SERVICE ‡∏ï‡∏≤‡∏°‡πÄ‡∏°‡∏•‡πå‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ</span></strong></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:19px;font-family:"Angsana New","serif";margin:0cm;margin-bottom:.0001pt;'><strong><u><span style='font-family:"Leelawadee","sans-serif";color:blue;background:yellow;'>** ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡∏ö‡∏¥‡∏•‡∏£‡∏±‡∏ö‡∏ã‡πà‡∏≠‡∏°</span></u></strong><strong><span style='font-family:"Leelawadee","sans-serif";color:blue;'>&nbsp;</span></strong><strong><span style='font-family:"Leelawadee","sans-serif";color:black;'><br>&nbsp;<br>&nbsp;</span></strong><strong><span style='font-family:"Leelawadee","sans-serif";color:blue;'>‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡∏ö‡∏¥‡∏•‡∏£‡∏±‡∏ö‡∏ã‡πà‡∏≠‡∏° ‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏° ‡∏ú‡∏π‡πâ‡∏ã‡∏∑‡πâ‡∏≠ ‡πÄ‡∏õ‡πá‡∏ô&nbsp;</span></strong><strong><span style='font-family:"Leelawadee","sans-serif";color:blue;'>CASH ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô &nbsp;<u><span style="background:yellow;">RMA0004</span></u>&nbsp; (‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏Ç‡∏≤</span></strong><span style='font-family:"Leelawadee","sans-serif";color:blue;'>)</span><span style='font-family:"Leelawadee","sans-serif";color:black;'>&nbsp;</span></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:19px;font-family:"Angsana New","serif";margin:0cm;margin-bottom:.0001pt;'><strong><span style='font-family:"Leelawadee","sans-serif";color:blue;'>‡∏Å‡∏£‡∏ì‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏°‡∏î‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡πÄ‡∏Ñ‡∏•‡∏°&nbsp;</span></strong><strong><span style='font-family:"Leelawadee","sans-serif";color:blue;font-weight:normal;'>‡∏ú‡∏π‡πâ‡∏ã‡∏∑‡πâ‡∏≠&nbsp;</span></strong><strong><span style='font-family:"Leelawadee","sans-serif";color:blue;'>‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ&nbsp;</span></strong><strong><u><span style='font-family:"Leelawadee","sans-serif";color:blue;background:yellow;'>RMA0001</span></u></strong><strong><span style='font-family:"Leelawadee","sans-serif";color:blue;'>&nbsp;‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ù‡∏≤‡∏Å‡∏ã‡πà‡∏≠‡∏° ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</span></strong></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:19px;font-family:"Angsana New","serif";margin:0cm;margin-bottom:.0001pt;'><strong><span style='font-family:"Leelawadee","sans-serif";color:blue;'><img src="https://i.imgur.com/5IIsEbo.jpg"></span></strong><br></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:19px;font-family:"Angsana New","serif";margin:0cm;margin-bottom:.0001pt;'><span style='font-family:"Leelawadee","sans-serif";color:black;'>&nbsp;&nbsp;</span><strong><u><span style='font-family:"Leelawadee","sans-serif";color:blue;background:yellow;'>** ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°</span></u></strong><span style='font-family:"Leelawadee","sans-serif";color:black;'><br>&nbsp;</span><span style='font-family:"Leelawadee","sans-serif";color:black;'><br>&nbsp;</span><strong><span style='font-family:"Leelawadee","sans-serif";color:blue;'>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°‡πÉ‡∏ô&nbsp;</span></strong><strong><span style='font-family:"Leelawadee","sans-serif";color:blue;'>CODE : 166 ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£ <u><span style="background:yellow;">Stock Out ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏™‡∏µ‡∏¢ ‡πÑ‡∏õ‡∏ó‡∏µ‡πà 33</span></u> *‡∏ó‡∏≥‡πÉ‡∏ô ITEC INSURANCE /FC - ITEC SERVICE (‡∏ó‡∏≥‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ Trade in</span></strong><span style='font-family:"Leelawadee","sans-serif";color:black;'>) <strong><span style="background:yellow;">‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠&nbsp;</span></strong></span><strong><span style='font-family:"Leelawadee","sans-serif";color:black;background:yellow;'>Get CODE</span></strong><strong><span style='font-size:21px;font-family:"Leelawadee","sans-serif";'><br></span></strong></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:19px;font-family:"Angsana New","serif";margin:0cm;margin-bottom:.0001pt;'><strong><span style='font-family:"Leelawadee","sans-serif";color:blue;'><img src="https://i.imgur.com/lGmI5wo.jpg"></span></strong><br></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:19px;font-family:"Angsana New","serif";margin:0cm;margin-bottom:.0001pt;'><strong><span style='font-family:"Leelawadee","sans-serif";color:blue;'><img src="https://i.imgur.com/8HsLQgO.jpg"></span></strong><br></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:19px;font-family:"Angsana New","serif";margin:0cm;margin-bottom:.0001pt;'><strong><span style='font-size:21px;font-family:"Leelawadee","sans-serif";color:blue;'>&nbsp;&nbsp;</span></strong><strong><span style='font-size:21px;font-family:"Leelawadee","sans-serif";color:blue;'>**‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á ‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤**</span></strong></p>
<p style='margin-right:0cm;margin-left:0cm;font-size:19px;font-family:"Angsana New","serif";margin:0cm;margin-bottom:.0001pt;'><strong><span style='font-size:21px;font-family:"Leelawadee","sans-serif";color:blue;'>Line Q&amp;A Service : &nbsp;</span></strong><strong><span style='font-size:21px;font-family:"Leelawadee","sans-serif";color:blue;background:yellow;'><a href="https://page.line.me/533aagih"><strong><span style='font-family:"Leelawadee","sans-serif";color:blue;'>https://page.line.me/533aagih</span></strong></a></span></strong></p>
<p style='font-size: 19px; font-family: "Angsana New", "serif"; margin: 0cm 0cm 0.0001pt; text-align: center;'>+++++++++++++++++++++++++++++++++++++++</p>

<p style='margin:0cm;margin-bottom:.0001pt;font-size:15px;font-family:"Tahoma","sans-serif";'><img width="228" src="https://www.bb-talkin.eu/bbe/wp-content/uploads/2018/12/DHL-parcel-logo-250x200.jpg"></p>

        <p style='margin:0cm;margin-bottom:.0001pt;font-size:19px;font-family:"Tahoma","serif";'><span style="font-size:16px;color:#212121;">‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô ID : ''' + str(branch3) + '''</span></p>
        <p style='margin-right:0cm;margin-left:0cm;font-size:19px;font-family:"Angsana New","serif";margin:0cm;margin-bottom:.0001pt;'><br></p>
        <p style='margin-right:0cm;margin-left:0cm;font-size:19px;font-family:"Angsana New","serif";margin:0cm;margin-bottom:.0001pt;'><span style='font-size:15px;font-family:"Tahoma","sans-serif";'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style='font-size:19px;font-family:"Cordia New","sans-serif";'>‡πÅ‡∏à‡πâ‡∏á‡πÉ‡∏´‡πâ</span><span style='font-size:19px;font-family:"Cordia New","sans-serif";'>&nbsp;</span><span style='font-size:15px;font-family:"Tahoma","sans-serif";'>Print Label&nbsp;</span><span style='font-size:29px;font-family:"Cordia New","sans-serif";'>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</span><span style='font-size:24px;font-family:"Cordia New","sans-serif";color:#1F497D;'>‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°&nbsp;</span><span style='font-size:19px;font-family:"Cordia New","sans-serif";'>&nbsp;<span style="color:#1F497D;">(&nbsp;</span></span><u><span style='font-size:24px;font-family:"Cordia New","sans-serif";color:#1F497D;'>‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á ‡πÅ‡∏ú‡∏ô‡∏Å&nbsp;</span></u><u><span style='font-size:24px;font-family:"Cordia New","sans-serif";color:#1F497D;'>Service (‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°&nbsp;ITEC Service -</span></u><u><span style='font-size:35px;font-family:"Cordia New","sans-serif";color:#1F497D;'>&nbsp;Insure</span></u><u><span style='font-size:24px;font-family:"Cordia New","sans-serif";color:#1F497D;'>&nbsp;)</span></u><span style='font-size:19px;font-family:"Cordia New","sans-serif";'>&nbsp;<span style="background:yellow;">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà ‡∏ö‡∏¥‡∏•</span><span style="background:yellow;">&nbsp;</span></span><span style='font-size:15px;font-family:"Tahoma","sans-serif";background:yellow;'>PHY ID: ''' + str(value1) + ''' &nbsp;:</span><span style='font-size:15px;font-family:"Tahoma","sans-serif";'>&nbsp; &nbsp; &nbsp;&nbsp;</span><strong><u><span style='font-size:24px;font-family:"Cordia New","sans-serif";color:red;'>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô&nbsp;</span></u></strong><strong><u><span style='font-size:24px;font-family:"Cordia New","sans-serif";color:red;'>1 &nbsp;‡∏Å‡∏•‡πà‡∏≠‡∏á &nbsp;&nbsp;</span></u></strong><strong><u><span style='font-size:24px;font-family:"Tahoma","sans-serif";color:red;'>/ '''  + str(amouth4) + '''&nbsp;&nbsp;</span></u></strong><strong><u><span style='font-size:24px;font-family:"Cordia New","sans-serif";color:red;'>‡∏ö‡∏¥‡∏•</span></u></strong><span style='font-size:19px;font-family:"Cordia New","sans-serif";color:red;'>&nbsp;&nbsp;</span><span style='font-size:15px;font-family:"Tahoma","sans-serif";'>*** <u>Print Label&nbsp;</u></span><u><span style='font-size:19px;font-family:"Cordia New","sans-serif";'>‡∏ï‡∏≤‡∏°</span></u><u><span style='font-size:19px;font-family:"Cordia New","sans-serif";'>&nbsp;</span></u><u><span style='font-size:15px;font-family:"Tahoma","sans-serif";'>file&nbsp;</span></u><u><span style='font-size:19px;font-family:"Cordia New","sans-serif";'>‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏ö‡∏°‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</span></u><span style='font-size:19px;font-family:"Cordia New","sans-serif";'>&nbsp;</span><span style='font-size:15px;font-family:"Tahoma","sans-serif";'>***</span></p>
        <p style='margin:0cm;margin-bottom:.0001pt;font-size:19px;font-family:"Tahoma","serif";'><span style='font-size:15px;font-family:"Verdana","sans-serif";color:#212121;'>&nbsp;</span><span style='font-size:15px;font-family:"Cordia New","sans-serif";color:#212121;'>***</span><span style='font-size:15px;font-family:"Verdana","sans-serif";color:#212121;'>&nbsp;&nbsp;</span><span style='font-size:15px;font-family:"Cordia New","sans-serif";color:#1F497D;'>‡πÉ‡∏ä‡πâ ‡∏Ç‡∏ô‡∏™‡πà‡∏á</span><span style='font-size:15px;font-family:"Verdana","sans-serif";color:#1F497D;'>&nbsp;</span><span style='font-size:15px;font-family:"Verdana","sans-serif";color:#1F497D;'>DHL &nbsp;</span><span style="font-size:15px;color:#1F497D;">‡∏£‡∏ö‡∏Å‡∏ß‡∏ô ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÅ‡∏û‡∏Ñ ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏•‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á ‡∏£‡∏≠ ‡∏Ç‡∏ô‡∏™‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡πà‡∏∞</span><span style='font-size:15px;font-family:"Verdana","sans-serif";color:#1F497D;'>&nbsp;</span><span style='font-size:15px;font-family:"Verdana","sans-serif";color:#1F497D;'>&nbsp;</span><span style='font-size:15px;font-family:"Cordia New","sans-serif";color:#1F497D;'>‡∏´‡∏≤‡∏Å‡∏Ç‡∏ô‡∏™‡πà‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏±‡∏ö</span><span style='font-size:15px;font-family:"Verdana","sans-serif";color:#1F497D;'>&nbsp;&nbsp;</span><span style='font-size:15px;font-family:"Cordia New","sans-serif";color:#1F497D;'>‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 2 ‡∏ß‡∏±‡∏ô ‡πÉ‡∏´‡πâ ‡πÅ‡∏à‡πâ‡∏á‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤</span><span style='font-size:15px;font-family:"Verdana","sans-serif";color:#212121;'>&nbsp;/&nbsp;</span><span style='font-size:15px;font-family:"Browallia New","sans-serif";color:#212121;'>‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</span><span style='font-size:15px;font-family:"Verdana","sans-serif";color:#212121;'>&nbsp;</span><span style='font-size:15px;font-family:"Verdana","sans-serif";color:#212121;'>**&nbsp;</span><span style='font-size:15px;font-family:"Verdana","sans-serif";color:#1F497D;'>&nbsp;</span><span style='font-size:15px;font-family:"Calibri","sans-serif";color:#1F497D;'><a href="https://page.line.me/533aagih" id="LPlnk282976"><span style='font-family:"Verdana","sans-serif";'>https://page.line.me/533aagih</span></a></span><span style='font-size:15px;font-family:"Verdana","sans-serif";color:#1F497D;'>&nbsp;</span><span style='font-size:15px;font-family:"Verdana","sans-serif";color:#1F497D;'>&nbsp; (‡∏û‡∏µ‡πà‡∏≠‡πâ‡∏≠)</span></p>
        <p style='margin:0cm;margin-bottom:.0001pt;font-size:19px;font-family:"Tahoma","serif";text-indent:36.0pt;'><span style='font-size:15px;font-family:"Cordia New","sans-serif";color:#1F497D;'>&nbsp; &nbsp;</span><strong><span style="color:#1F497D;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></strong></p>
        <p style='margin:0cm;margin-bottom:.0001pt;font-size:19px;font-family:"Tahoma","serif";text-indent:36.0pt;'><strong><span style="color:#1F497D;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç&nbsp;</span></strong></p>
        <p style='margin:0cm;margin-bottom:.0001pt;font-size:19px;font-family:"Tahoma","serif";'><span style='font-size:15px;font-family:"Verdana","sans-serif";color:#212121;'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ***&nbsp;</span><span style='font-size:15px;font-family:"Cordia New","sans-serif";color:#212121;'>1.</span><span style='font-size:15px;font-family:"Verdana","sans-serif";color:#212121;'>&nbsp;</span><span style='font-size:15px;font-family:"Cordia New","sans-serif";color:white;background:navy;'>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏ï‡∏¥‡∏î</span><span style='font-size:15px;font-family:"Verdana","sans-serif";color:white;background:navy;'>&nbsp;</span><span style='font-size:15px;font-family:"Verdana","sans-serif";color:white;background:navy;'>Label&nbsp;</span><span style="font-size:15px;color:white;background:navy;">‡∏™‡∏•‡∏±‡∏ö ‡∏´‡∏£‡∏∑‡∏≠ ‡∏ú‡∏¥‡∏î ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏¥‡∏• ‡∏ô‡∏∞‡∏Ñ‡∏∞</span></p>
        <p style='margin:0cm;margin-bottom:.0001pt;font-size:19px;font-family:"Tahoma","serif";'><span style='font-size:15px;font-family:"Verdana","sans-serif";color:#212121;'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style='font-size:15px;font-family:"Verdana","sans-serif";color:#212121;'>***</span><span style='font-size:15px;font-family:"Verdana","sans-serif";color:#212121;'>&nbsp;</span><span style='font-size:15px;font-family:"Cordia New","sans-serif";color:#212121;'>2.</span><span style='font-size:15px;font-family:"Verdana","sans-serif";color:#212121;'>&nbsp;</span><span style='font-size:15px;font-family:"Cordia New","sans-serif";color:white;background:red;'>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏°‡∏µ</span><span style='font-size:15px;font-family:"Verdana","sans-serif";color:white;background:red;'>&nbsp;</span><span style='font-size:15px;font-family:"Verdana","sans-serif";color:white;background:red;'>Label&nbsp;</span><span style='font-size:15px;font-family:"Verdana","sans-serif";color:white;background:red;'>&nbsp;</span><span style='font-size:15px;font-family:"Cordia New","sans-serif";color:white;background:red;'>‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏†‡∏≤‡∏û‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏≥‡∏°‡∏≤‡πÉ‡∏ä‡πâ ‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏∞</span></p>
        <p id="isPasted" style='margin:0cm;margin-bottom:.0001pt;font-size:19px;font-family:"Tahoma","serif";'><span style='font-size:13px;font-family:"Segoe Print";color:#F89D52;'>B<strong>est Regards,</strong></span></p>
        <p style='margin:0cm;margin-bottom:.0001pt;font-size:19px;font-family:"Tahoma","serif";'><strong><span style='font-size:13px;font-family:"Segoe Print";color:#F89D52;'>Kamolwan &nbsp;Aromsawa (AOR)</span></strong></p>
        <p style='margin:0cm;margin-bottom:.0001pt;font-size:19px;font-family:"Tahoma","serif";'><strong><span style='font-size:13px;font-family:"Segoe Print";color:#1D1B11;'>Customer Service</span></strong></p>
        <p style='margin:0cm;margin-bottom:.0001pt;font-size:19px;font-family:"Tahoma","serif";'><strong><span style='font-size:16px;font-family:"Segoe Print";color:black;'>Email:</span></strong><strong><span style='font-size:16px;font-family:"Calibri","sans-serif";color:black;'>&nbsp;<a href="mailto:Kamolwan@comseven.com" id="LPNoLP">Kamolwan@comseven.com</a> &nbsp;</span></strong></p>
        <p style='margin:0cm;margin-bottom:.0001pt;font-size:19px;font-family:"Tahoma","serif";'><strong><span style='font-size:16px;font-family:"Segoe UI Symbol","sans-serif";color:black;'>üî∏üî∏üî∏üî∏üî∏üî∏üî∏üî∏üî∏üî∏üî∏üî∏üî∏</span></strong></p>
        <p><span style='font-size:16px;font-family:"Calibri","sans-serif";color:black;'>02-017-7777 # 7312</span></p>
        <p style='margin:0cm;margin-bottom:.0001pt;font-size:15px;font-family:"Tahoma","sans-serif";'><img src="https://i.imgur.com/zGEe9kH.jpg"></p>
        <p style='margin:0cm;margin-bottom:.0001pt;font-size:19px;font-family:"Tahoma","serif";'><br></p>
        <p style='margin:0cm;margin-bottom:.0001pt;font-size:19px;font-family:"Tahoma","serif";'><br></p>
        <p style='margin:0cm;margin-bottom:.0001pt;font-size:19px;font-family:"Tahoma","serif";'><br></p>

        </body> \
        </html>      '''       
        mail.HTMLBody = html
        mail.Attachments.Add(Source=root1.filedir + '/' + str(value1) + '.pdf')
        if From != None:
        # This line basically calls the "mail.SendUsingAccount = xyz@email.com" outlook VBA command
            mail._oleobj_.Invoke(*(64209, 0, 8, 0, From))
        
        mail.Send()
        row += 1
        if value1 is None:
            break
        elif email2 is None:
            break
        else:
            continue
sentmail()